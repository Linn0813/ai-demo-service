# ğŸ¨ å‰ç«¯é¡µé¢æ”¹è¿›æ–¹æ¡ˆ

## ğŸ“‹ å½“å‰é—®é¢˜åˆ†æ

1. **å¸ƒå±€é—®é¢˜**ï¼šå·¦å³åˆ†æ å¸ƒå±€ä¸å¤Ÿç›´è§‚ï¼Œé…ç½®å’Œç»“æœåˆ†ç¦»
2. **è¿›åº¦å±•ç¤º**ï¼šç¼ºå°‘è¯¦ç»†çš„æ‰§è¡Œæ­¥éª¤å’Œå®æ—¶è¿›åº¦
3. **ä»»åŠ¡å…³è”**ï¼šè™½ç„¶æœ‰ä»»åŠ¡ç³»ç»Ÿï¼Œä½†è¿›åº¦ä¿¡æ¯ä¸å¤Ÿè¯¦ç»†
4. **ç”¨æˆ·ä½“éªŒ**ï¼šæ— æ³•çœ‹åˆ°ä»»åŠ¡çš„å…·ä½“æ‰§è¡Œé˜¶æ®µ

---

## ğŸ¯ æ”¹è¿›æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šå‚ç›´æµç¨‹å¼å¸ƒå±€ï¼ˆæ¨èï¼‰

#### å¸ƒå±€ç»“æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [é…ç½®åŒºåŸŸ - å¯æŠ˜å ]                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ¨¡å‹é€‰æ‹© | åŠŸèƒ½ç‚¹ä¸Šé™ | é«˜çº§å‚æ•°    â”‚ â”‚
â”‚  â”‚ éœ€æ±‚æ–‡æ¡£ä¸Šä¼ /è¾“å…¥                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ä»»åŠ¡è¿›åº¦åŒºåŸŸ - å®æ—¶æ›´æ–°]                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“Š ä»»åŠ¡çŠ¶æ€: æ‰§è¡Œä¸­                â”‚ â”‚
â”‚  â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘ 60%                   â”‚ â”‚
â”‚  â”‚                                     â”‚ â”‚
â”‚  â”‚ ğŸ“ æ‰§è¡Œæ­¥éª¤:                        â”‚ â”‚
â”‚  â”‚ âœ… 1. æå–åŠŸèƒ½æ¨¡å— (3/5)            â”‚ â”‚
â”‚  â”‚ ğŸ”„ 2. ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ (2/5)           â”‚ â”‚
â”‚  â”‚ â³ 3. éªŒè¯å’Œä¿®å¤ (ç­‰å¾…ä¸­)           â”‚ â”‚
â”‚  â”‚                                     â”‚ â”‚
â”‚  â”‚ ğŸ“‹ å½“å‰å¤„ç†: åŠŸèƒ½ç‚¹ "ç¡çœ èŠ‚å¾‹åˆ†æ"   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ç»“æœå±•ç¤ºåŒºåŸŸ - åŠ¨æ€åŠ è½½]                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“¦ æµ‹è¯•ç”¨ä¾‹åˆ—è¡¨ (å®æ—¶è¿½åŠ )          â”‚ â”‚
â”‚  â”‚ åŠŸèƒ½ç‚¹1: 3ä¸ªç”¨ä¾‹ âœ…                 â”‚ â”‚
â”‚  â”‚ åŠŸèƒ½ç‚¹2: 2ä¸ªç”¨ä¾‹ âœ…                 â”‚ â”‚
â”‚  â”‚ åŠŸèƒ½ç‚¹3: ç”Ÿæˆä¸­... ğŸ”„               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¼˜åŠ¿
- âœ… æµç¨‹æ¸…æ™°ï¼šä»ä¸Šåˆ°ä¸‹å±•ç¤ºå®Œæ•´æµç¨‹
- âœ… è¿›åº¦å¯è§†ï¼šå®æ—¶æ˜¾ç¤ºæ¯ä¸ªé˜¶æ®µçš„è¿›åº¦
- âœ… ç»“æœå®æ—¶ï¼šæµ‹è¯•ç”¨ä¾‹é€æ­¥å±•ç¤ºï¼Œä¸ç”¨ç­‰å¾…å…¨éƒ¨å®Œæˆ
- âœ… ç©ºé—´åˆ©ç”¨ï¼šé…ç½®å¯æŠ˜å ï¼ŒèŠ‚çœç©ºé—´

---

### æ–¹æ¡ˆäºŒï¼šå¡ç‰‡å¼ä»»åŠ¡ä¸­å¿ƒ

#### å¸ƒå±€ç»“æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [å·¦ä¾§: é…ç½®é¢æ¿ - å›ºå®šå®½åº¦]              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ ç”Ÿæˆé…ç½®         â”‚                   â”‚
â”‚  â”‚ - æ¨¡å‹é€‰æ‹©       â”‚                   â”‚
â”‚  â”‚ - åŠŸèƒ½ç‚¹ä¸Šé™     â”‚                   â”‚
â”‚  â”‚ - éœ€æ±‚æ–‡æ¡£       â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ ä»»åŠ¡å†å²         â”‚                   â”‚
â”‚  â”‚ - ä»»åŠ¡1 (å®Œæˆ)   â”‚                   â”‚
â”‚  â”‚ - ä»»åŠ¡2 (è¿›è¡Œä¸­) â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å³ä¾§: ä»»åŠ¡è¯¦æƒ…å’Œç»“æœ - ä¸»åŒºåŸŸ]          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“‹ å½“å‰ä»»åŠ¡: #12345                â”‚ â”‚
â”‚  â”‚ çŠ¶æ€: ğŸ”„ æ‰§è¡Œä¸­                     â”‚ â”‚
â”‚  â”‚ è¿›åº¦: â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘ 60%              â”‚ â”‚
â”‚  â”‚                                     â”‚ â”‚
â”‚  â”‚ ğŸ“Š æ‰§è¡Œè¯¦æƒ…:                        â”‚ â”‚
â”‚  â”‚ [æ—¶é—´çº¿ç»„ä»¶]                        â”‚ â”‚
â”‚  â”‚ 10:30:15 âœ… å¼€å§‹æå–åŠŸèƒ½æ¨¡å—        â”‚ â”‚
â”‚  â”‚ 10:30:45 âœ… æå–å®Œæˆ (5ä¸ª)          â”‚ â”‚
â”‚  â”‚ 10:31:00 ğŸ”„ ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ (2/5)      â”‚ â”‚
â”‚  â”‚                                     â”‚ â”‚
â”‚  â”‚ ğŸ“¦ ç”Ÿæˆç»“æœ:                        â”‚ â”‚
â”‚  â”‚ [æµ‹è¯•ç”¨ä¾‹åˆ—è¡¨]                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¼˜åŠ¿
- âœ… ä»»åŠ¡ç®¡ç†ï¼šå¯ä»¥æŸ¥çœ‹å†å²ä»»åŠ¡
- âœ… å¤šä»»åŠ¡ï¼šæ”¯æŒåŒæ—¶æŸ¥çœ‹å¤šä¸ªä»»åŠ¡
- âœ… æ—¶é—´çº¿ï¼šæ¸…æ™°çš„æ‰§è¡Œæ—¶é—´çº¿

---

## ğŸ”§ åç«¯æ”¹è¿›éœ€æ±‚

### 1. å¢å¼ºä»»åŠ¡è¿›åº¦ä¿¡æ¯

**å½“å‰é—®é¢˜**ï¼š`progress` å­—æ®µæ˜¯ `Optional[Dict[str, Any]]`ï¼Œä½†æ²¡æœ‰è¢«æ›´æ–°

**æ”¹è¿›æ–¹æ¡ˆ**ï¼šåœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­æ›´æ–°è¿›åº¦

```python
# åœ¨ domain/test_case/service.py ä¸­
def generate_test_cases(self, ...):
    # æ›´æ–°ä»»åŠ¡è¿›åº¦
    task_manager = get_task_manager()
    
    # é˜¶æ®µ1: æå–åŠŸèƒ½æ¨¡å—
    task_manager.update_progress(task_id, {
        "stage": "extracting_modules",
        "progress": 0,
        "message": "æ­£åœ¨æå–åŠŸèƒ½æ¨¡å—..."
    })
    
    modules = self.extract_function_modules(...)
    
    # é˜¶æ®µ2: ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
    total = len(modules)
    for i, module in enumerate(modules):
        task_manager.update_progress(task_id, {
            "stage": "generating_test_cases",
            "progress": int((i + 1) / total * 100),
            "current": i + 1,
            "total": total,
            "message": f"æ­£åœ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ ({i+1}/{total}): {module['name']}"
        })
        # ... ç”Ÿæˆé€»è¾‘
    
    # é˜¶æ®µ3: éªŒè¯å’Œä¿®å¤
    task_manager.update_progress(task_id, {
        "stage": "validating",
        "progress": 90,
        "message": "æ­£åœ¨éªŒè¯å’Œä¿®å¤æµ‹è¯•ç”¨ä¾‹..."
    })
```

### 2. æ·»åŠ ä»»åŠ¡è¿›åº¦æ›´æ–°æ–¹æ³•

```python
# åœ¨ domain/task/manager.py ä¸­æ·»åŠ 
def update_progress(self, task_id: str, progress_info: Dict[str, Any]):
    """æ›´æ–°ä»»åŠ¡è¿›åº¦"""
    with self._lock:
        task_info = self._tasks.get(task_id)
        if task_info:
            task_info["progress"] = progress_info
            log.debug(f"ä»»åŠ¡è¿›åº¦æ›´æ–°: {task_id} - {progress_info}")
```

### 3. æ”¯æŒéƒ¨åˆ†ç»“æœè¿”å›

```python
# åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è¿”å›éƒ¨åˆ†ç»“æœ
task_manager.update_partial_result(task_id, {
    "test_cases": current_test_cases,  # å·²ç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹
    "by_function_point": current_by_function_point,
    "meta": {
        "processed_function_points": i + 1,
        "total_function_points": total
    }
})
```

---

## ğŸ¨ å‰ç«¯æ”¹è¿›éœ€æ±‚

### 1. è¿›åº¦å±•ç¤ºç»„ä»¶

```vue
<template>
  <div class="task-progress">
    <!-- æ€»ä½“è¿›åº¦æ¡ -->
    <el-progress 
      :percentage="progress.percentage" 
      :status="progress.status"
      :stroke-width="16"
    />
    
    <!-- é˜¶æ®µåˆ—è¡¨ -->
    <div class="stage-list">
      <div 
        v-for="(stage, index) in stages" 
        :key="index"
        :class="['stage-item', stage.status]"
      >
        <el-icon>
          <component :is="getStageIcon(stage.status)" />
        </el-icon>
        <span class="stage-name">{{ stage.name }}</span>
        <span class="stage-progress" v-if="stage.progress">
          ({{ stage.current }}/{{ stage.total }})
        </span>
        <span class="stage-message">{{ stage.message }}</span>
      </div>
    </div>
    
    <!-- å½“å‰å¤„ç†é¡¹ -->
    <div class="current-item" v-if="progress.currentItem">
      <el-icon><Loading /></el-icon>
      <span>æ­£åœ¨å¤„ç†: {{ progress.currentItem }}</span>
    </div>
  </div>
</template>
```

### 2. å®æ—¶ç»“æœå±•ç¤º

```vue
<template>
  <div class="result-container">
    <!-- åŠŸèƒ½ç‚¹åˆ—è¡¨ -->
    <div 
      v-for="fp in functionPoints" 
      :key="fp.id"
      class="function-point-card"
    >
      <div class="fp-header">
        <span class="fp-name">{{ fp.name }}</span>
        <el-tag :type="getStatusType(fp.status)">
          {{ fp.statusText }}
        </el-tag>
      </div>
      
      <!-- æµ‹è¯•ç”¨ä¾‹åˆ—è¡¨ï¼ˆå®æ—¶è¿½åŠ ï¼‰ -->
      <div class="test-cases-list">
        <div 
          v-for="tc in fp.testCases" 
          :key="tc.id"
          class="test-case-item"
        >
          {{ tc.case_name }}
        </div>
        <div v-if="fp.status === 'generating'" class="loading">
          <el-icon><Loading /></el-icon>
          ç”Ÿæˆä¸­...
        </div>
      </div>
    </div>
  </div>
</template>
```

### 3. ä»»åŠ¡çŠ¶æ€è½®è¯¢ä¼˜åŒ–

```javascript
// ä¼˜åŒ–è½®è¯¢é€»è¾‘
const POLLING_INTERVAL = 2000 // 2ç§’

const fetchTaskStatus = async () => {
  try {
    const response = await aiApi.getTaskStatus(taskId.value)
    const taskData = response.data.data
    
    // æ›´æ–°è¿›åº¦
    updateProgress(taskData.progress)
    
    // æ›´æ–°éƒ¨åˆ†ç»“æœï¼ˆå¦‚æœå­˜åœ¨ï¼‰
    if (taskData.partial_result) {
      updatePartialResults(taskData.partial_result)
    }
    
    // å¦‚æœå®Œæˆï¼Œè·å–æœ€ç»ˆç»“æœ
    if (taskData.status === 'completed') {
      stopPolling()
      applyFinalResult(taskData.result)
    }
  } catch (error) {
    handleError(error)
  }
}
```

---

## ğŸ“Š æ”¹è¿›æ•ˆæœå¯¹æ¯”

| ç‰¹æ€§ | å½“å‰æ–¹æ¡ˆ | æ”¹è¿›æ–¹æ¡ˆ |
|------|---------|---------|
| è¿›åº¦å±•ç¤º | ç®€å•ç™¾åˆ†æ¯” | è¯¦ç»†é˜¶æ®µ+ç™¾åˆ†æ¯” |
| ç»“æœå±•ç¤º | å…¨éƒ¨å®Œæˆåæ˜¾ç¤º | å®æ—¶é€æ­¥æ˜¾ç¤º |
| ä»»åŠ¡å…³è” | å¼±å…³è” | å¼ºå…³è”ï¼Œå¯æŸ¥çœ‹å†å² |
| ç”¨æˆ·ä½“éªŒ | ç­‰å¾…æ—¶é—´é•¿ | å®æ—¶åé¦ˆï¼Œä½“éªŒå¥½ |
| é”™è¯¯å¤„ç† | å¤±è´¥åæ‰çŸ¥é“ | å®æ—¶æ˜¾ç¤ºé”™è¯¯ |

---

## ğŸš€ å®æ–½æ­¥éª¤

### é˜¶æ®µä¸€ï¼šåç«¯å¢å¼ºï¼ˆ1-2å¤©ï¼‰
1. âœ… æ·»åŠ  `update_progress` æ–¹æ³•åˆ° TaskManager
2. âœ… åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­æ›´æ–°è¿›åº¦
3. âœ… æ”¯æŒéƒ¨åˆ†ç»“æœè¿”å›
4. âœ… æ›´æ–° API å“åº”æ ¼å¼

### é˜¶æ®µäºŒï¼šå‰ç«¯å¸ƒå±€é‡æ„ï¼ˆ2-3å¤©ï¼‰
1. âœ… å®ç°æ–°çš„å¸ƒå±€ç»„ä»¶
2. âœ… å®ç°è¿›åº¦å±•ç¤ºç»„ä»¶
3. âœ… å®ç°å®æ—¶ç»“æœå±•ç¤º
4. âœ… ä¼˜åŒ–è½®è¯¢é€»è¾‘

### é˜¶æ®µä¸‰ï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1å¤©ï¼‰
1. âœ… åŠŸèƒ½æµ‹è¯•
2. âœ… æ€§èƒ½ä¼˜åŒ–
3. âœ… ç”¨æˆ·ä½“éªŒä¼˜åŒ–

---

## ğŸ’¡ é¢å¤–å»ºè®®

### 1. ä»»åŠ¡å†å²åŠŸèƒ½
- ä¿å­˜æœ€è¿‘10ä¸ªä»»åŠ¡
- å¯ä»¥æŸ¥çœ‹å†å²ä»»åŠ¡çš„è¯¦æƒ…å’Œç»“æœ
- æ”¯æŒé‡æ–°æ‰§è¡Œæˆ–å¯¼å‡ºç»“æœ

### 2. WebSocket æ”¯æŒï¼ˆå¯é€‰ï¼‰
- å¦‚æœä»»åŠ¡å¾ˆå¤šï¼Œå¯ä»¥è€ƒè™‘ WebSocket æ¨é€
- å‡å°‘è½®è¯¢å‹åŠ›
- å®æ—¶æ€§æ›´å¥½

### 3. å¯¼å‡ºåŠŸèƒ½
- æ”¯æŒå¯¼å‡ºæµ‹è¯•ç”¨ä¾‹ä¸º Excel/JSON
- æ”¯æŒå¯¼å‡ºä»»åŠ¡æŠ¥å‘Š

---

**æ¨èæ–¹æ¡ˆ**ï¼šæ–¹æ¡ˆä¸€ï¼ˆå‚ç›´æµç¨‹å¼å¸ƒå±€ï¼‰+ åç«¯è¿›åº¦å¢å¼º

è¿™ä¸ªæ–¹æ¡ˆå®ç°ç®€å•ï¼Œç”¨æˆ·ä½“éªŒå¥½ï¼Œä¸”ä¸ç°æœ‰ä»»åŠ¡ç³»ç»Ÿå®Œç¾ç»“åˆã€‚

